#!/bin/sh

set -eu

newsboat() {
    LANG=C command newsboat "$@"
}

unread() {
    unread=$(newsboat -x print-unread 2>/dev/null | cut -d' ' -f1)
    integer -p "${unread}" && test "${unread}" -ne 0 && printf '\uf09e %s\n' "${unread}" && return 0
    printf '\n'
}

unread; sleep 1
while rwc -e "${XDG_CACHE_HOME:-~/.cache}"/newsboat/cache.db >/dev/null; do
    unread; sleep 1
done

