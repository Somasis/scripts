#!/bin/sh

set -eu

newsboat() {
    LANG=C command newsboat "$@"
}

unread() {
    newsboat -x print-unread 2>/dev/null | sed -E "$(printf '/Error:/d; s/ .*//; s/^0$//; s/^[0-9]+/\uf09e &/')"
}

unread; sleep 1
while rwc -e "${XDG_CACHE_HOME:-~/.cache}"/newsboat/cache.db >/dev/null; do
    unread; sleep 1
done

